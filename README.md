# System Architecture Overview
üá≠üá∫ Hungarian version available here:
> [Rendszerarchitekt√∫ra ‚Äì √Åttekint√©s](README_HU.md)

This document describes the high-level architecture and core design principles of the system. The goal is to ensure **deterministic, auditable, and version-controlled gameplay**, where on-chain and off-chain components are strictly aligned through shared, verifiable rules.

---

## Core Architecture

The system consists of **five clearly separated main components**, each with a well-defined responsibility.

### 1. Versioned Content Database

A version-controlled public data source that defines the **rules and content of the system**.

* Ensures **verifiable and auditable expansion** of game rules and content
* Every content change is versioned and immutable once published
* Serves as the single source of truth for gameplay rules

This database is designed to allow the system to evolve **without breaking historical determinism**.

---

### 2. On-Chain State Management (Contracts)

Smart contracts are responsible for **all on-chain state transitions**, based exclusively on the **currently active content version**.

* No hardcoded game logic beyond minimal validation
* All behavior is derived from versioned content
* Guarantees that on-chain outcomes are reproducible and rule-bound

---

### 3. Versioned Rule Interpreter (Off-Chain)

A version-controlled off-chain codebase that interprets gameplay actions according to the **active content version**.

* Acts as a deterministic rule interpreter
* Supervises off-chain gameplay flows
* Ensures that all player actions conform to the same rule set used on-chain

This component bridges real-time gameplay with on-chain determinism.

---

### 4. Public Gameplay Action Database

A public, append-only database storing **validated gameplay actions**.

* Every action is validated by the rule interpreter
* Strict access and modification controls
* Enables full replay, audit, and verification of any game session

This database represents the **public history of gameplay**.

---

### 5. Authorized Transaction Endpoint

An authorization layer responsible for validating **reward claims and external constraints**.

* Verifies reward eligibility based on the public gameplay database
* Controls authorized reward-claim transactions
* Validates external data such as:

  * Avatar names
  * Community guideline compliance

Only players with **provably valid gameplay outcomes** can claim rewards.

---

## GameContent Contract (Core Component)

The **GameContent contract** is the most critical element of the entire system.

Its purpose is to make **all game rules and content publicly verifiable, versioned, and extensible**.

### Responsibilities

* Stores the **currently active content snapshot** (only data required for on-chain validation)
* Maintains **hash-based versioning** of content
* Provides a foundation for future **audit code versioning**

For efficiency reasons, the contract does **not store the full content**, only the subset that directly affects on-chain behavior.

---

### Audit Codebase (Future Phase)

A planned audit codebase will be introduced with **hash-based version tracking**, referenced by the GameContent contract.

* Acts as a reducer over gameplay actions
* Validates actions based on:

  * Active content version
  * NFTs owned by participants in the given game
* Supervises off-chain gameplay deterministically

The resulting action log is stored in the public gameplay database.

---

## Reward Eligibility and Claims

* Game winners earn the **right to claim rewards** through valid gameplay
* Rewards are claimed via **authorized on-chain transactions**
* Eligibility is derived exclusively from validated gameplay history

There is no discretionary reward distribution.

---

## Asset Generation Sources

NFTs and tokens generated by the system originate from multiple sources (beyond loot chests):

### 1. Failed Upgrades

* Special resources may be generated as a result of unsuccessful upgrade attempts
* Failure is treated as a meaningful, rule-defined outcome

---

### 2. NPC-Based Trading (GameNPC Contract)

* Dynamically rotating NPCs with limited supply
* Fully on-chain supervised trading logic
* NPC availability and offers are rule-defined and time-dependent

---

### 3. Player Marketplace (GameMarket Contract)

* Peer-to-peer trading between players
* Supports:

  * Utility token
  * Flow token
* Backed by an external indexed database for efficient discovery

The marketplace remains **non-custodial** and rule-driven.

---

## NFT Model

The system defines **three NFT types**, all implementing a shared interface.

* `category` and `type` fields determine internal structure and behavior
* NFT behavior is defined in a **public, versioned content database**

### NFT Types

#### BaseNFT

* Resources required for upgrades and crafting

#### MetaNFT

* Upgradeable NFTs with distinct roles and functions
* Core gameplay assets

#### PackNFT

* NFTs that enable storage, grouping, and batch operations
* Designed to simplify inventory management and trading

---

## Design Principles

* Determinism over convenience
* Verifiability over trust
* Versioned evolution instead of mutable rules
* Clear separation between authority, validation, and execution

This architecture ensures that **every meaningful game outcome can be independently verified**, both on-chain and off-chain.
